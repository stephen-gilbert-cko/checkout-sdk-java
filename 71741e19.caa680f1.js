(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{148:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return o})),n.d(t,"rightToc",(function(){return u})),n.d(t,"Highlight",(function(){return i})),n.d(t,"default",(function(){return l}));var a=n(2),r=n(9),s=(n(0),n(157)),c={id:"payments",title:"Payments"},o={id:"payments",isDocsHomePage:!1,title:"Payments",description:"You can find a list of request body parameters and possible outcomes here.",source:"@site/docs/payments.md",permalink:"/checkout-sdk-java/payments",sidebar:"someSidebar",previous:{title:"Error Handling",permalink:"/checkout-sdk-java/errors"},next:{title:"Sources",permalink:"/checkout-sdk-java/sources"}},u=[{value:'Request a card payment with a <Highlight color="#25c2a0">card token</Highlight>',id:"request-a-card-payment-with-a-card-token",children:[]},{value:'Request a card payment with a <Highlight color="#25c2a0">full card details</Highlight>',id:"request-a-card-payment-with-a-full-card-details",children:[]},{value:'Request a card payment with a <Highlight color="#25c2a0">an existing card</Highlight>',id:"request-a-card-payment-with-a-an-existing-card",children:[]},{value:'Request a card payment with a <Highlight color="#25c2a0">an existing customer</Highlight>',id:"request-a-card-payment-with-a-an-existing-customer",children:[]},{value:'Request a payment for a <Highlight color="#25c2a0">local payment method</Highlight>',id:"request-a-payment-for-a-local-payment-method",children:[]},{value:'Request a <Highlight color="#25c2a0">3D Secure payment</Highlight>',id:"request-a-3d-secure-payment",children:[]},{value:'Handle card <Highlight color="#25c2a0">payment responses</Highlight>',id:"handle-card-payment-responses",children:[]},{value:"Get payment details",id:"get-payment-details",children:[]},{value:"Get payment actions",id:"get-payment-actions",children:[]},{value:"Capture a payment",id:"capture-a-payment",children:[]},{value:"Refund a payment",id:"refund-a-payment",children:[]},{value:"Void a payment",id:"void-a-payment",children:[]}],i=function(e){var t=e.children,n=e.color;return Object(s.b)("span",{style:{color:n,padding:"0.2rem"}},t)},p={rightToc:u,Highlight:i};function l(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(s.b)("wrapper",Object(a.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(s.b)("p",null,"You can find a list of request body parameters and possible outcomes ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://api-reference.checkout.com/#tag/Payments"}),"here"),"."),Object(s.b)("h2",{id:"request-a-card-payment-with-a-card-token"},"Request a card payment with a ",Object(s.b)(i,{color:"#25c2a0",mdxType:"Highlight"},"card token")),Object(s.b)("p",null,"The card token is generated by front-end integration options such as ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://docs.checkout.com/docs/frames"}),"Frames")," or one of the ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://docs.checkout.com/docs/sdks#section-mobile-sdk-libraries"}),"Mobile SDKs"),". Keep in mind that this token expires in 15 minutes and can only be used once."),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'TokenSource tokenSource = new TokenSource("tok_ubfj2q76miwundwlk72vxt2i7q");\n\nCustomerRequest customer = new CustomerRequest();\ncustomer.setEmail("user@email.com");\ncustomer.setName("James Bond");\n\nPaymentRequest<TokenSource> paymentRequest =\n  PaymentRequest.fromSource(tokenSource, Currency.USD, 1000); //cents\npaymentRequest.setCustomer(customer);\npaymentRequest.setReference("ORD-123");\n\nPaymentResponse response = api.paymentsClient().requestAsync(paymentRequest).get();\n')),Object(s.b)("h2",{id:"request-a-card-payment-with-a-full-card-details"},"Request a card payment with a ",Object(s.b)(i,{color:"#25c2a0",mdxType:"Highlight"},"full card details")),Object(s.b)("div",{className:"admonition admonition-warning alert alert--danger"},Object(s.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(s.b)("h5",{parentName:"div"},Object(s.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(s.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(s.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"})))),"warning")),Object(s.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(s.b)("p",{parentName:"div"},"You need to have a high level of PCI Compliance (SAQ-D) to be able to send requests with full card details. Note that unless this payment option is enabled on your account by Checkout.com, the ",Object(s.b)(i,{color:"#5A522C",mdxType:"Highlight"},"request will fail"),". Contact you account manager to request access for this payment interaction."))),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'CardSource cardSource = new CardSource("4242424242424242", 6, 2025);\ncardSource.setCvv("100");\n\nCustomerRequest customer = new CustomerRequest();\ncustomer.setEmail("user@email.com");\ncustomer.setName("James Bond");\n\nPaymentRequest<CardSource> paymentRequest =\n  PaymentRequest.fromSource(cardSource, Currency.USD, 1000); //cents\npaymentRequest.setCustomer(customer);\npaymentRequest.setReference("ORD-123");\n\nPaymentResponse response = api.paymentsClient().requestAsync(paymentRequest).get();\n')),Object(s.b)("h2",{id:"request-a-card-payment-with-a-an-existing-card"},"Request a card payment with a ",Object(s.b)(i,{color:"#25c2a0",mdxType:"Highlight"},"an existing card")),Object(s.b)("p",null,"After you perform at least one successful payment for a customer, Checkout.com will return a ",Object(s.b)(i,{color:"#02b48f",mdxType:"Highlight"},"source.id"),". This id does not expire, so it can be used to perform subsequent payments without needing the customer to enter the card details again."),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'IdSource idSource = new IdSource("src_vg3tm54ndfbefotjlmgrrvbxli");\n\nCustomerRequest customer = new CustomerRequest();\ncustomer.setEmail("user@email.com");\ncustomer.setName("James Bond");\n\nPaymentRequest<IdSource> paymentRequest =\n  PaymentRequest.fromSource(idSource, Currency.USD, 1000); //cents\npaymentRequest.setCustomer(customer);\npaymentRequest.setReference("ORD-456");\n\nPaymentResponse response = api.paymentsClient().requestAsync(paymentRequest).get();\n')),Object(s.b)("h2",{id:"request-a-card-payment-with-a-an-existing-customer"},"Request a card payment with a ",Object(s.b)(i,{color:"#25c2a0",mdxType:"Highlight"},"an existing customer")),Object(s.b)("p",null,"After you perform at least one successful payment for a customer, Checkout.com will return a ",Object(s.b)(i,{color:"#02b48f",mdxType:"Highlight"},"customer.id"),". This id can be used perform payments without needing the customer to enter the card details again."),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'CustomerSource customerSource =\n  new CustomerSource("cus_6artgoevd77u7ojah2wled32sa");\n\nPaymentRequest<CustomerSource> paymentRequest =\n  PaymentRequest.fromSource(customerSource, Currency.USD, 1000); //cents\npaymentRequest.setReference("ORD-456");\n\nPaymentResponse response = api.paymentsClient().requestAsync(paymentRequest).get();\n')),Object(s.b)("h2",{id:"request-a-payment-for-a-local-payment-method"},"Request a payment for a ",Object(s.b)(i,{color:"#25c2a0",mdxType:"Highlight"},"local payment method")),Object(s.b)("p",null,"The ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://api-reference.checkout.com/#tag/Payments/paths/~1payments/post"}),"API Reference")," contains a list of local payment options that you can use, as well as the other information required in the payment source (if required)."),Object(s.b)("p",null,"This is an example of a payment request for ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://docs.checkout.com/payment-methods/bank-transfers/giropay"}),"Giropay"),":"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'AlternativePaymentSource alternativePaymentSource =\n  new AlternativePaymentSource("giropay");\nalternativePaymentSource.put("bic", "TESTDETT421");\nalternativePaymentSource.put("purpose", "CKO Giropay test");\n\nPaymentRequest<RequestSource> paymentRequest =\n  PaymentRequest.fromSource(alternativePaymentSource, Currency.EUR, 1000); //cents\n\nPaymentResponse response = api.paymentsClient().requestAsync(paymentRequest).get();\n')),Object(s.b)("p",null,"This request is meant to return a redirection URL, so you can let the customer complete the transaction on the local payment method's website. Normally a successful response would look like this:"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n  "id": "pay_d3ohhwwu3qderfjlzitknc26sq",\n  "status": "Pending",\n  "customer": {\n    "id": "cus_hfgq4ctsnr6e3cfhq5ctwb5gtu"\n  },\n  "_links": {\n    "self": {\n      "href": "https://api.sandbox.checkout.com/payments/pay_d3ohhwwu3qderfjlzitknc26sq"\n    },\n    "redirect": {\n      "href": "https://ftg-customer-integration.giropay.de/ftgbank/b/bankselection/219499703994809788;jsessionid=8ECFE1809F9BAB6635EC9D37D98A1CAE.sf-testapp01tom21?op=001"\n    }\n  }\n}\n')),Object(s.b)("p",null,"You can access the redirection URL via the SDK like so:"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"PaymentPending pendingPayment = response.getPending();\n// Your redirect link\npendingPayment.getRedirectLink();\n")),Object(s.b)("h2",{id:"request-a-3d-secure-payment"},"Request a ",Object(s.b)(i,{color:"#25c2a0",mdxType:"Highlight"},"3D Secure payment")),Object(s.b)("p",null,"You have the ability to authenticate with 3DS in a payment request. The request body is similar to normal card payments, but with some additional parameters. ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://docs.checkout.com/docs/3d-secure-payments"}),"Read more about 3DS")),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'TokenSource tokenSource = new TokenSource("tok_ubfj2q76miwundwlk72vxt2i7q");\n\nCustomerRequest customer = new CustomerRequest();\ncustomer.setEmail("user@email.com");\ncustomer.setName("James Bond");\n\nPaymentRequest<TokenSource> paymentRequest =\n  PaymentRequest.fromSource(tokenSource, Currency.USD, 1000); //cents\npaymentRequest.setCustomer(customer);\npaymentRequest.setReference("ORD-123");\npaymentRequest.setThreeDS(ThreeDSRequest.from(true)); //3DS: enabled\n\nPaymentResponse response = api.paymentsClient().requestAsync(paymentRequest).get();\n')),Object(s.b)("p",null,"Similarly to local payment options, 3D Secure payments will return a redirection URL. Here is an example of a 3DS response:"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n  "id": "pay_hehfmlkpykeupofyxf7nbr6yyy",\n  "status": "Pending",\n  "customer": {\n    "id": "cus_u4a4zosnrw7ehhzr7jipbkdzo4"\n  },\n  "3ds": {\n    "downgraded": false,\n    "enrolled": "Y"\n  },\n  "_links": {\n    "self": {\n      "href": "https://api.sandbox.checkout.com/payments/pay_hehfmlkpykeupofyxf7nbr6yyy"\n    },\n    "redirect": {\n      "href": "https://sandbox.checkout.com/api2/v2/3ds/acs/sid_feixbit6us3utfedjulm6egnsu"\n    }\n  }\n}\n')),Object(s.b)("p",null,"You can access the redirection URL via the SDK like so:"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"PaymentPending pendingPayment = response.getPending();\n// Your redirect link\npendingPayment.getRedirectLink();\n")),Object(s.b)("h2",{id:"handle-card-payment-responses"},"Handle card ",Object(s.b)(i,{color:"#25c2a0",mdxType:"Highlight"},"payment responses")),Object(s.b)("p",null,"Payment requests are influenced by risk rules so you can have situations where a card payment is requested without 3D Secure, but upgraded by a risk rule, resulting in a 3D Secure response. You are free to handle the response in any way you want, but bellow you have a good example for a starting point:"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),'try {\n  PaymentResponse response = api.paymentsClient().requestAsync(...).get();\n\n  if (response.isPending()) {\n    // Local/3DS payment. Redirect the customer to payment.getPending().getRedirectLink()\n  } else if (response.getPayment().isApproved() && !response.getPayment().getRisk()) {\n    // The payment was successful and not flagged by any risk rule\n  } else if (response.getPayment().isApproved() && response.getPayment().getRisk()) {\n    /* The payment was successful but it was flagged by a risk rule;\n       this means you need to manually decide if you want to capture it or void it */\n  } else if (!response.getPayment().isApproved()) {\n    // The payment was declined\n  }\n} catch (Exception e) {\n  LOG.severe("Payment response could not be handled");\n  throw e;\n}\n')),Object(s.b)("h2",{id:"get-payment-details"},"Get payment details"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'GetPaymentResponse payment = api.paymentsClient().getAsync("pay_je5hbbb4u3oe7k4u3lbwlu3zkq").get(); // or with session id sid_XXX\n')),Object(s.b)("h2",{id:"get-payment-actions"},"Get payment actions"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'List<PaymentAction> paymentActions = api.paymentsClient().getActionsAsync("pay_juevt3h5mcjulir2t5g3wfug6u").get();\n')),Object(s.b)("h2",{id:"capture-a-payment"},"Capture a payment"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'// Full capture\napi.paymentsClient().captureAsync("pay_je5hbbb4u3oe7k4u3lbwlu3zkq").get();\n\n// Or partial capture\nCaptureRequest captureRequest = CaptureRequest.builder()\n  .reference("your reference")\n  .amount(100)\n  .build();\n\napi.paymentsClient().captureAsync("pay_je5hbbb4u3oe7k4u3lbwlu3zkq", captureRequest).get();\n')),Object(s.b)("h2",{id:"refund-a-payment"},"Refund a payment"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'// Full refund\napi.paymentsClient().refundAsync("pay_je5hbbb4u3oe7k4u3lbwlu3zkq").get();\n\n// Or partial refund\nRefundRequest refundRequest = RefundRequest.builder()\n  .reference("your reference")\n  .amount(100)\n  .build();\n\napi.paymentsClient().refundAsync("pay_je5hbbb4u3oe7k4u3lbwlu3zkq", refundRequest).get();\n')),Object(s.b)("h2",{id:"void-a-payment"},"Void a payment"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'api.paymentsClient().voidAsync("pay_je5hbbb4u3oe7k4u3lbwlu3zkq").get();\n')))}l.isMDXComponent=!0},157:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return b}));var a=n(0),r=n.n(a);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var i=r.a.createContext({}),p=function(e){var t=r.a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},l=function(e){var t=p(e.components);return r.a.createElement(i.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,s=e.originalType,c=e.parentName,i=u(e,["components","mdxType","originalType","parentName"]),l=p(n),d=a,b=l["".concat(c,".").concat(d)]||l[d]||m[d]||s;return n?r.a.createElement(b,o(o({ref:t},i),{},{components:n})):r.a.createElement(b,o({ref:t},i))}));function b(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=n.length,c=new Array(s);c[0]=d;var o={};for(var u in t)hasOwnProperty.call(t,u)&&(o[u]=t[u]);o.originalType=e,o.mdxType="string"==typeof e?e:a,c[1]=o;for(var i=2;i<s;i++)c[i]=n[i];return r.a.createElement.apply(null,c)}return r.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);